# haqua34 ビルドガイド

天キーで余り基板をもらっていただきありがとうございます。  
文章のみになりますが、ビルドガイドになります。

写真については、[gku34](https://github.com/tamago324/gku34/blob/master/docs/rev0.3/buildguide.md) のビルドガイドを見ていただけると助かります。

<details><summary>目次</summary><div>

* [キットに含まれるもの](#キットに含まれるもの)
* [キット以外に必要なもの](#キット以外に必要なもの)
* [組み立て順序の確認](#組み立て順序の確認)
* [組み立て](#組み立て)
  * [1. プレートの側面をペンで塗る](#1-プレートの側面をペンで塗るる)
  * [2. RP2040-Zero のボタンをペンで塗る](#2-rp2040-zero-のボタンをペンで塗る)
  * [3. ダイオードのはんだ付け](#3-ダイオードのはんだ付け)
  * [4. RP2040-Zero のはんだ付け](#4-rp2040-zero-のはんだ付け)
  * [5. TRRSジャック のはんだ付け](#5-trrsジャック-のはんだ付け)
  * [6. 動作確認](#6-動作確認)
  * [7. スイッチのはんだ付け](#7-スイッチのはんだ付け)
  * [8. ボトムプレートを取り付ける](#8-ボトムプレートを取り付ける)
  * [9. ゴム足を取り付ける](#9-ゴム足を取り付ける)
  * [10. キーキャップを取り付ける](#10-キーキャップを取り付ける)
  * [11. キーマップの変更](#11-キーマップの変更)
* [最後に](#最後に)

</div></details>


## キットに含まれるもの

| No. | 名前                  | 数量        | 備考                                                                                                                                                                        |
|-----|-----------------------|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1   | PCB (左)                   | 1枚         | メインPCB (左)                                                                                                                                                                   |
| 2   | PCB (右)                   | 1枚         | メインPCB (右)                                                                                                                                                                  |
| 3   | ボトムプレート (左)        | 1枚         | ボトムプレート (左)                                                                                                                                                     |
| 4   | ボトムプレート (右)        | 1枚         | ボトムプレート (右)                                                                                                                                                      |
| 5   | ゴム足            | 12個 | [Amazon](https://amzn.asia/d/dPdWZld)で購入できます。                                                                |
| 6   | 両面テープ (5mm幅)    | -           | PCBとボトムプレートを張り合わせるために使用。 <br>[Amazon](https://amzn.asia/d/8XeKmsn)で購入できます。 |

## キット以外に必要なもの

| 名前                     | 数量 | 備考                 |
|--------------------------|------|----------------------|
| トッププレート (左)        | 1枚         | JLCPCBで製造してもらった3Dプリント製のトッププレート                                                                                                           |
| トッププレート (右)        | 1枚         | JLCPCBで製造してもらった3Dプリント製のトッププレート                                                                                                           |
| ダイオード            | 34個 + 予備 | [遊舎工房](https://shop.yushakobo.jp/collections/all-keyboard-parts/products/a0800di-02-100)で購入できます。                                                                |
| RP2040-Zero             | 2個 |[TALP KEYBAORD](https://talpkeyboard.net/items/640ea9f3072c3c538731c515) などで購入できます。 |
| TRRSジャック             | 2個 | [TALP KEYBOARD](https://talpkeyboard.net/items/5fa25a06da019c17f0664dc7)で購入できます。 |
| ピンヘッダ | - | RP2040-Zero をまっすぐはんだ付けするために使用するピンヘッダ (※ なくても組み立ては可能ですが、あったほうがまっすぐ半田付けできるため、あると良いです。) |
| キーキャップ            | 34個 | choc v1用、またはMX用キーキャップ<br>Lofreeスイッチを取り付ける場合、Junana MX キーキャップがおすすめです。([1U 凹形](https://booth.pm/ja/items/5551574)、[1U 凸形](https://booth.pm/ja/items/5551877))  |
| キースイッチ             | 34個 | choc v1スイッチ、または [Lofree スイッチ](https://www.lofree.co/products/lofree-x-kailh-full-pom-low-profile-switches)         |
| USBケーブル              | 1個  | Type-C の USBケーブル |

### トッププレートについて

トッププレートは JLCPCB に製造してもらう必要があります。  
輸送会社を OCS にすると送料が安くなるのでオススメです。  
トッププレートは左右で異なるため、それぞれ1つずつ発注してください。  

* left: `data/rev0.1/stl/top_plate_left.stl`
  * 3D Technology: MJF(Nylon)
  * Material: PA12-HP Nylon
  * Color: Black
* right: `data/rev0.1/stl/top_plate_right.stl`
  * 3D Technology: MJF(Nylon)
  * Material: PA12-HP Nylon
  * Color: Black

## 組み立て順序の確認

1. プレートの側面をペンで塗る
2. RP2040-Zero のボタンをペンで塗る
3. ダイオードのはんだ付け
4. RP2040-Zero のはんだ付け
5. TRRSジャック のはんだ付け
6. 動作確認
7. スイッチのはんだ付け
8. ボトムプレートを取り付ける
9. ゴム足を取り付ける
10. キーキャップを取り付ける
11. キーマップの変更

## 組み立て


### 1. プレートの側面をペンで塗る

PCB と ボトムプレートの側面を[ポスカ](https://amzn.asia/d/1ZZTGt9)などのペンで塗ります。

### 2. RP2040-Zero のボタンをペンで塗る

RP2040-Zero のボタンを[マッキー](https://amzn.asia/d/gaXAFb8)などのペンで塗ります。

これをすることにより、トッププレートを合わせたときに真っ黒になります。


### 3. ダイオードのはんだ付け

PCBの裏にダイオードを34個はんだ付けします。  
「PCBのシルクの線」と「ダイオードの線」が一致するようにはんだ付けします。  
はんだごての温度は320℃くらいに設定し作業します。  

片側に予備ハンダを行い、
ピンセットを使用して、はんだ付けを行い、
もう片方もはんだ付けします。

すべてのダイオードのはんだ付けが終わったら、すべてのダイオードが同じ向きになっていることを確認してください。

### 4. RP2040-Zero のはんだ付け

「PCB の表面の 5V」が「RP2040-Zero の 5V」にあうように合わせます。  
ピンヘッダを RP2040-Zero と PCB に刺して、まっすぐなるように合わせます。  
RP2040-Zero の角を4箇所はんだ付けをし、浮いていないことを確認してから、すべてをはんだ付けします。

### 5. TRRSジャック のはんだ付け

トッププレートで数か所スイッチをはめて (半田付けではなく、はめるだけ)、TRRSジャックの半田付けする位置を確認します。  
位置が決まったら、テープなどでTRRSジャックを固定し、半田付けをします。

### 6. 動作確認

#### ファームウェアの書き込み

[こちら](https://github.com/tamago324/keyboard-firmwares)で `haqua34:via` のファームウェアを作成します。

RP2040-Zero の左側のボタンを押しながら、USB を接続し、
新しいデバイスとしてファイルエクスプローラに表示されたデバイスに、ダウンロードしたファイルををコピーします。コピーが完了すると、デバイスが切断されます。
デバイスが切断されたら、ファームウェアの書き込みが完了です。


#### 入力の確認

**XXX: TRRSケーブルを左右で接続してから、USBケーブルを指してください。**

[Remap](https://remap-keys.app/) にアクセスし、`START REMAP FOR YOUR KEYBOARD` ボタンをクリック

`+KEYBAORD` をクリックし、表示された `haqua34` を選択し、`接続` をクリック

Import JSON の画面で、 [remap.json](https://github.com/tamago324/keyboard-firmwares/blob/master/keyboards/haqua34/keymaps/via/remap.json) をインポートします。

`Test Matrix Mode` をクリックし、入力の確認を行う。

スイッチのピンの穴をピンセットでショートさせることで入力を確認します。

### 7. スイッチのはんだ付け

トッププレートとPCBを合わせて、PCBの表からスイッチを差し込み、裏からスイッチをはんだ付けします。
はんだごての温度は320℃くらいに設定し作業します。

ボトムプレートを張り付ける前に念のため、再度 Remap で入力の確認をしておきます。  
もし、入力がおかしい場合、ダイオードやスイッチの足にはんだごてをあてて、再度確認します。

### 8. ボトムプレートを取り付ける

両面テープをボトムプレートに貼り付け、PCBとボトムプレートがずれないように貼り付けます。

両面テープの貼る面は、よく確認してから貼ってください。

### 9. ゴム足を取り付ける

ボトムプレートにゴム足を取り付けます。

### 10. キーキャップを取り付ける

キーキャップを取り付けます。

### 11. キーマップの変更

[keyboard-firmwares](https://github.com/tamago324/keyboard-firmwares) でファームウェアを作成し、変更可能です。

## 最後に

組み立てありがとうございました！

感想などありましたら、SNS などでつぶやいていただけると嬉しいです。  



